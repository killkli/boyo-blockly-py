!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["indexeddb-fs"]={})}(this,(function(e){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var t=function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},t.apply(this,arguments)};function r(e,t,r,n){return new(r||(r=Promise))((function(a,o){function i(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}u((n=n.apply(e,t||[])).next())}))}function n(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var a=function(e){return"string"==typeof e||e instanceof String},o=new RegExp("^([A-Za-z]:|[A-Za-z0-9_-]+(.[A-Za-z0-9_-]+)*)((/[A-Za-z0-9_.-]+)+)$");var i=function(e,t){return r(void 0,void 0,void 0,(function(){var r;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return[2,n.sent()];case 2:return r=n.sent(),t&&t(r),[3,3];case 3:return[2,null]}}))}))};function s(e,t){for(var r=0,n=e.length-1;n>=0;n--){var a=e[n];"."===a?e.splice(n,1):".."===a?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}var u=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,c=function(e){return u.exec(e).slice(1)};function f(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:"/";if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(e=n+"/"+e,t="/"===n.charAt(0))}return(t?"/":"")+(e=s(m(e.split("/"),(function(e){return!!e})),!t).join("/"))||"."}function h(e){var t=l(e),r="/"===p(e,-1);return(e=s(m(e.split("/"),(function(e){return!!e})),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e}function l(e){return"/"===e.charAt(0)}var d={extname:function(e){return c(e)[3]},basename:function(e,t){var r=c(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},dirname:function(e){var t=c(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},sep:"/",delimiter:":",relative:function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=f(e).substr(1),t=f(t).substr(1);for(var n=r(e.split("/")),a=r(t.split("/")),o=Math.min(n.length,a.length),i=o,s=0;s<o;s++)if(n[s]!==a[s]){i=s;break}var u=[];for(s=i;s<n.length;s++)u.push("..");return(u=u.concat(a.slice(i))).join("/")},join:function(){var e=Array.prototype.slice.call(arguments,0);return h(m(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},isAbsolute:l,normalize:h,resolve:f};function m(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var p="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)};function v(e,t){var r=d.dirname(e);return"."===r?t:r}function y(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t}
/*! https://mths.be/punycode v1.4.1 by @mathias */var b=2147483647,g=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,F={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=Math.floor,x=String.fromCharCode;function E(e){throw new RangeError(F[e])}function j(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function z(e,t,r){var n=0;for(e=r?A(e/700):e>>1,e+=A(e/t);e>455;n+=36)e=A(e/35);return A(n+36*e/(e+38))}function O(e){return function(e,t){var r=e.split("@"),n="";r.length>1&&(n=r[0]+"@",e=r[1]);var a=function(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}((e=e.replace(w,".")).split("."),t).join(".");return n+a}(e,(function(e){return g.test(e)?"xn--"+function(e){var t,r,n,a,o,i,s,u,c,f,h,l,d,m,p,v=[];for(e=function(e){for(var t,r,n=[],a=0,o=e.length;a<o;)(t=e.charCodeAt(a++))>=55296&&t<=56319&&a<o?56320==(64512&(r=e.charCodeAt(a++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),a--):n.push(t);return n}(e),l=e.length,t=128,r=0,o=72,i=0;i<l;++i)(h=e[i])<128&&v.push(x(h));for(n=a=v.length,a&&v.push("-");n<l;){for(s=b,i=0;i<l;++i)(h=e[i])>=t&&h<s&&(s=h);for(s-t>A((b-r)/(d=n+1))&&E("overflow"),r+=(s-t)*d,t=s,i=0;i<l;++i)if((h=e[i])<t&&++r>b&&E("overflow"),h==t){for(u=r,c=36;!(u<(f=c<=o?1:c>=o+26?26:c-o));c+=36)p=u-f,m=36-f,v.push(x(j(f+p%m,0))),u=A(p/m);v.push(x(j(u,0))),o=z(r,d,n==a),r=0,++n}++r,++t}return v.join("")}(e):e}))}function S(e){return null===e}function Z(e){return"string"==typeof e}function D(e){return"object"==typeof e&&null!==e}function $(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var N=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function R(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function P(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var _=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t};function C(e,t,r,n){t=t||"&",r=r||"=";var a={};if("string"!=typeof e||0===e.length)return a;var o=/\+/g;e=e.split(t);var i=1e3;n&&"number"==typeof n.maxKeys&&(i=n.maxKeys);var s=e.length;i>0&&s>i&&(s=i);for(var u=0;u<s;++u){var c,f,h,l,d=e[u].replace(o,"%20"),m=d.indexOf(r);m>=0?(c=d.substr(0,m),f=d.substr(m+1)):(c=d,f=""),h=decodeURIComponent(c),l=decodeURIComponent(f),$(a,h)?N(a[h])?a[h].push(l):a[h]=[a[h],l]:a[h]=l}return a}var I={parse:W,resolve:te,resolveObject:re,format:Q,Url:k};function k(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var q=/^([a-z0-9.+-]+:)/i,V=/:[0-9]*$/,M=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,T=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),L=["'"].concat(T),U=["%","/","?",";","#"].concat(L),B=["/","?","#"],J=/^[+a-z0-9A-Z_-]{0,63}$/,Y=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,G={javascript:!0,"javascript:":!0},H={javascript:!0,"javascript:":!0},K={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function W(e,t,r){if(e&&D(e)&&e instanceof k)return e;var n=new k;return n.parse(e,t,r),n}function X(e,t,r,n){if(!Z(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var a=t.indexOf("?"),o=-1!==a&&a<t.indexOf("#")?"?":"#",i=t.split(o);i[0]=i[0].replace(/\\/g,"/");var s=t=i.join(o);if(s=s.trim(),!n&&1===t.split("#").length){var u=M.exec(s);if(u)return e.path=s,e.href=s,e.pathname=u[1],u[2]?(e.search=u[2],e.query=r?C(e.search.substr(1)):e.search.substr(1)):r&&(e.search="",e.query={}),e}var c,f,h,l,d=q.exec(s);if(d){var m=(d=d[0]).toLowerCase();e.protocol=m,s=s.substr(d.length)}if(n||d||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var p="//"===s.substr(0,2);!p||d&&H[d]||(s=s.substr(2),e.slashes=!0)}if(!H[d]&&(p||d&&!K[d])){var v,y,b=-1;for(c=0;c<B.length;c++)-1!==(f=s.indexOf(B[c]))&&(-1===b||f<b)&&(b=f);for(-1!==(y=-1===b?s.lastIndexOf("@"):s.lastIndexOf("@",b))&&(v=s.slice(0,y),s=s.slice(y+1),e.auth=decodeURIComponent(v)),b=-1,c=0;c<U.length;c++)-1!==(f=s.indexOf(U[c]))&&(-1===b||f<b)&&(b=f);-1===b&&(b=s.length),e.host=s.slice(0,b),s=s.slice(b),ne(e),e.hostname=e.hostname||"";var g="["===e.hostname[0]&&"]"===e.hostname[e.hostname.length-1];if(!g){var w=e.hostname.split(/\./);for(c=0,h=w.length;c<h;c++){var F=w[c];if(F&&!F.match(J)){for(var A="",x=0,E=F.length;x<E;x++)F.charCodeAt(x)>127?A+="x":A+=F[x];if(!A.match(J)){var j=w.slice(0,c),z=w.slice(c+1),S=F.match(Y);S&&(j.push(S[1]),z.unshift(S[2])),z.length&&(s="/"+z.join(".")+s),e.hostname=j.join(".");break}}}}e.hostname.length>255?e.hostname="":e.hostname=e.hostname.toLowerCase(),g||(e.hostname=O(e.hostname)),l=e.port?":"+e.port:"";var D=e.hostname||"";e.host=D+l,e.href+=e.host,g&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!G[m])for(c=0,h=L.length;c<h;c++){var $=L[c];if(-1!==s.indexOf($)){var N=encodeURIComponent($);N===$&&(N=escape($)),s=s.split($).join(N)}}var R=s.indexOf("#");-1!==R&&(e.hash=s.substr(R),s=s.slice(0,R));var P=s.indexOf("?");if(-1!==P?(e.search=s.substr(P),e.query=s.substr(P+1),r&&(e.query=C(e.query)),s=s.slice(0,P)):r&&(e.search="",e.query={}),s&&(e.pathname=s),K[m]&&e.hostname&&!e.pathname&&(e.pathname="/"),e.pathname||e.search){l=e.pathname||"";var _=e.search||"";e.path=l+_}return e.href=ee(e),e}function Q(e){return Z(e)&&(e=X({},e)),ee(e)}function ee(e){var t=e.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var r=e.protocol||"",n=e.pathname||"",a=e.hash||"",o=!1,i="";e.host?o=t+e.host:e.hostname&&(o=t+(-1===e.hostname.indexOf(":")?e.hostname:"["+this.hostname+"]"),e.port&&(o+=":"+e.port)),e.query&&D(e.query)&&Object.keys(e.query).length&&(i=function(e,t,r,n){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?P(_(e),(function(n){var a=encodeURIComponent(R(n))+r;return N(e[n])?P(e[n],(function(e){return a+encodeURIComponent(R(e))})).join(t):a+encodeURIComponent(R(e[n]))})).join(t):n?encodeURIComponent(R(n))+r+encodeURIComponent(R(e)):""}(e.query));var s=e.search||i&&"?"+i||"";return r&&":"!==r.substr(-1)&&(r+=":"),e.slashes||(!r||K[r])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),a&&"#"!==a.charAt(0)&&(a="#"+a),s&&"?"!==s.charAt(0)&&(s="?"+s),r+o+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+a}function te(e,t){return W(e,!1,!0).resolve(t)}function re(e,t){return e?W(e,!1,!0).resolveObject(t):t}function ne(e){var t=e.host,r=V.exec(t);r&&(":"!==(r=r[0])&&(e.port=r.substr(1)),t=t.substr(0,t.length-r.length)),t&&(e.hostname=t)}k.prototype.parse=function(e,t,r){return X(this,e,t,r)},k.prototype.format=function(){return ee(this)},k.prototype.resolve=function(e){return this.resolveObject(W(e,!1,!0)).format()},k.prototype.resolveObject=function(e){if(Z(e)){var t=new k;t.parse(e,!1,!0),e=t}for(var r,n=new k,a=Object.keys(this),o=0;o<a.length;o++){var i=a[o];n[i]=this[i]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),u=0;u<s.length;u++){var c=s[u];"protocol"!==c&&(n[c]=e[c])}return K[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!K[e.protocol]){for(var f=Object.keys(e),h=0;h<f.length;h++){var l=f[h];n[l]=e[l]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||H[e.protocol])n.pathname=e.pathname;else{for(r=(e.pathname||"").split("/");r.length&&!(e.host=r.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==r[0]&&r.unshift(""),r.length<2&&r.unshift(""),n.pathname=r.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var d=n.pathname||"",m=n.search||"";n.path=d+m}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var p,v=n.pathname&&"/"===n.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),b=y||v||n.host&&e.pathname,g=b,w=n.pathname&&n.pathname.split("/")||[],F=n.protocol&&!K[n.protocol];if(r=e.pathname&&e.pathname.split("/")||[],F&&(n.hostname="",n.port=null,n.host&&(""===w[0]?w[0]=n.host:w.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===r[0]?r[0]=e.host:r.unshift(e.host)),e.host=null),b=b&&(""===r[0]||""===w[0])),y)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,w=r;else if(r.length)w||(w=[]),w.pop(),w=w.concat(r),n.search=e.search,n.query=e.query;else if(null!=e.search)return F&&(n.hostname=n.host=w.shift(),(p=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=p.shift(),n.host=n.hostname=p.shift())),n.search=e.search,n.query=e.query,S(n.pathname)&&S(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!w.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var A=w.slice(-1)[0],x=(n.host||e.host||w.length>1)&&("."===A||".."===A)||""===A,E=0,j=w.length;j>=0;j--)"."===(A=w[j])?w.splice(j,1):".."===A?(w.splice(j,1),E++):E&&(w.splice(j,1),E--);if(!b&&!g)for(;E--;E)w.unshift("..");!b||""===w[0]||w[0]&&"/"===w[0].charAt(0)||w.unshift(""),x&&"/"!==w.join("/").substr(-1)&&w.push("");var z=""===w[0]||w[0]&&"/"===w[0].charAt(0);return F&&(n.hostname=n.host=z?"":w.length?w.shift():"",(p=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=p.shift(),n.host=n.hostname=p.shift())),(b=b||n.host&&w.length)&&!z&&w.unshift(""),w.length?n.pathname=w.join("/"):(n.pathname=null,n.path=null),S(n.pathname)&&S(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},k.prototype.parseHost=function(){return ne(this)};var ae=y(Object.freeze({__proto__:null,parse:W,resolve:te,resolveObject:re,format:Q,default:I,Url:k})),oe={},ie=ae,se=oe.ValidationError=function(e,t,r,n,a,o){if(Array.isArray(n)?(this.path=n,this.property=n.reduce((function(e,t){return e+me(t)}),"instance")):void 0!==n&&(this.property=n),e&&(this.message=e),r){var i=r.$id||r.id;this.schema=i||r}void 0!==t&&(this.instance=t),this.name=a,this.argument=o,this.stack=this.toString()};se.prototype.toString=function(){return this.property+" "+this.message};var ue=oe.ValidatorResult=function(e,t,r,n){this.instance=e,this.schema=t,this.options=r,this.path=n.path,this.propertyPath=n.propertyPath,this.errors=[],this.throwError=r&&r.throwError,this.throwFirst=r&&r.throwFirst,this.throwAll=r&&r.throwAll,this.disableFormat=r&&!0===r.disableFormat};function ce(e,t){return t+": "+e.toString()+"\n"}function fe(e){Error.captureStackTrace&&Error.captureStackTrace(this,fe),this.instance=e.instance,this.schema=e.schema,this.options=e.options,this.errors=e.errors}ue.prototype.addError=function(e){var t;if("string"==typeof e)t=new se(e,this.instance,this.schema,this.path);else{if(!e)throw new Error("Missing error detail");if(!e.message)throw new Error("Missing error message");if(!e.name)throw new Error("Missing validator type");t=new se(e.message,this.instance,this.schema,this.path,e.name,e.argument)}if(this.errors.push(t),this.throwFirst)throw new fe(this);if(this.throwError)throw t;return t},ue.prototype.importErrors=function(e){"string"==typeof e||e&&e.validatorType?this.addError(e):e&&e.errors&&(this.errors=this.errors.concat(e.errors))},ue.prototype.toString=function(e){return this.errors.map(ce).join("")},Object.defineProperty(ue.prototype,"valid",{get:function(){return!this.errors.length}}),oe.ValidatorResultError=fe,fe.prototype=new Error,fe.prototype.constructor=fe,fe.prototype.name="Validation Error";var he=oe.SchemaError=function e(t,r){this.message=t,this.schema=r,Error.call(this,t),Error.captureStackTrace(this,e)};he.prototype=Object.create(Error.prototype,{constructor:{value:he,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var le=oe.SchemaContext=function(e,t,r,n,a){this.schema=e,this.options=t,Array.isArray(r)?(this.path=r,this.propertyPath=r.reduce((function(e,t){return e+me(t)}),"instance")):this.propertyPath=r,this.base=n,this.schemas=a};le.prototype.resolve=function(e){return ie.resolve(this.base,e)},le.prototype.makeChild=function(e,t){var r=void 0===t?this.path:this.path.concat([t]),n=e.$id||e.id,a=ie.resolve(this.base,n||""),o=new le(e,this.options,r,a,Object.create(this.schemas));return n&&!o.schemas[a]&&(o.schemas[a]=e),o};var de=oe.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,duration:/P(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S)|\d+(D|M(\d+D)?|Y(\d+M(\d+D)?)?)(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S))?|\d+W)/i,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"idn-email":/^("(?:[!#-\[\]-\u{10FFFF}]|\\[\t -\u{10FFFF}])*"|[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*)@([!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*|\[[!-Z\^-\u{10FFFF}]*\])$/u,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"uri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/,iri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"iri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~-\u{10FFFF}]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~-\u{10FFFF}])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/u,uuid:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,"uri-template":/(%[0-9a-f]{2}|[!#$&(-;=?@\[\]_a-z~]|\{[!#&+,./;=?@|]?(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?(,(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?)*\})*/iu,"json-pointer":/^(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*$/iu,"relative-json-pointer":/^\d+(#|(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*)$/iu,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"utc-millisec":function(e){return"string"==typeof e&&parseFloat(e)===parseInt(e,10)&&!isNaN(e)},regex:function(e){var t=!0;try{new RegExp(e)}catch(e){t=!1}return t},style:/[\r\n\t ]*[^\r\n\t ][^:]*:[\r\n\t ]*[^\r\n\t ;]*[\r\n\t ]*;?/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/};de.regexp=de.regex,de.pattern=de.regex,de.ipv4=de["ip-address"],oe.isFormat=function(e,t,r){if("string"==typeof e&&void 0!==de[t]){if(de[t]instanceof RegExp)return de[t].test(e);if("function"==typeof de[t])return de[t](e)}else if(r&&r.customFormats&&"function"==typeof r.customFormats[t])return r.customFormats[t](e);return!0};var me=oe.makeSuffix=function(e){return(e=e.toString()).match(/[.\s\[\]]/)||e.match(/^[\d]/)?e.match(/^\d+$/)?"["+e+"]":"["+JSON.stringify(e)+"]":"."+e};function pe(e,t,r,n){"object"==typeof r?t[n]=be(e[n],r):-1===e.indexOf(r)&&t.push(r)}function ve(e,t,r){t[r]=e[r]}function ye(e,t,r,n){"object"==typeof t[n]&&t[n]&&e[n]?r[n]=be(e[n],t[n]):r[n]=t[n]}function be(e,t){var r=Array.isArray(t),n=r&&[]||{};return r?(e=e||[],n=n.concat(e),t.forEach(pe.bind(null,e,n))):(e&&"object"==typeof e&&Object.keys(e).forEach(ve.bind(null,e,n)),Object.keys(t).forEach(ye.bind(null,e,t,n))),n}function ge(e){return"/"+encodeURIComponent(e).replace(/~/g,"%7E")}oe.deepCompareStrict=function e(t,r){if(typeof t!=typeof r)return!1;if(Array.isArray(t))return!!Array.isArray(r)&&(t.length===r.length&&t.every((function(n,a){return e(t[a],r[a])})));if("object"==typeof t){if(!t||!r)return t===r;var n=Object.keys(t),a=Object.keys(r);return n.length===a.length&&n.every((function(n){return e(t[n],r[n])}))}return t===r},oe.deepMerge=be,oe.objectGetPath=function(e,t){for(var r,n=t.split("/").slice(1);"string"==typeof(r=n.shift());){var a=decodeURIComponent(r.replace(/~0/,"~").replace(/~1/g,"/"));if(!(a in e))return;e=e[a]}return e},oe.encodePath=function(e){return e.map(ge).join("")},oe.getDecimalPlaces=function(e){var t=0;if(isNaN(e))return t;"number"!=typeof e&&(e=Number(e));var r=e.toString().split("e");if(2===r.length){if("-"!==r[1][0])return t;t=Number(r[1].slice(1))}var n=r[0].split(".");return 2===n.length&&(t+=n[1].length),t},oe.isSchema=function(e){return"object"==typeof e&&e||"boolean"==typeof e};var we=oe,Fe=we.ValidatorResult,Ae=we.SchemaError,xe={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,additionalItems:!0,then:!0,else:!0,$schema:!0,$ref:!0,extends:!0}},Ee=xe.validators={};function je(e,t,r,n,a){var o=t.throwError,i=t.throwAll;t.throwError=!1,t.throwAll=!1;var s=this.validateSchema(e,a,t,r);return t.throwError=o,t.throwAll=i,!s.valid&&n instanceof Function&&n(s),s.valid}function ze(e,t){if(Object.hasOwnProperty.call(e,t))return e[t];if(t in e)for(;e=Object.getPrototypeOf(e);)if(Object.propertyIsEnumerable.call(e,t))return e[t]}function Oe(e,t,r,n,a,o){if(this.types.object(e)&&(!t.properties||void 0===t.properties[a]))if(!1===t.additionalProperties)o.addError({name:"additionalProperties",argument:a,message:"is not allowed to have the additional property "+JSON.stringify(a)});else{var i=t.additionalProperties||{};"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,a,i,r,n);var s=this.validateSchema(e[a],i,r,n.makeChild(i,a));s.instance!==o.instance[a]&&(o.instance[a]=s.instance),o.importErrors(s)}}Ee.type=function(e,t,r,n){if(void 0===e)return null;var a=new Fe(e,t,r,n),o=Array.isArray(t.type)?t.type:[t.type];if(!o.some(this.testType.bind(this,e,t,r,n))){var i=o.map((function(e){if(e){var t=e.$id||e.id;return t?"<"+t+">":e+""}}));a.addError({name:"type",argument:i,message:"is not of a type(s) "+i})}return a},Ee.anyOf=function(e,t,r,n){if(void 0===e)return null;var a=new Fe(e,t,r,n),o=new Fe(e,t,r,n);if(!Array.isArray(t.anyOf))throw new Ae("anyOf must be an array");if(!t.anyOf.some(je.bind(this,e,r,n,(function(e){o.importErrors(e)})))){var i=t.anyOf.map((function(e,t){var r=e.$id||e.id;return r?"<"+r+">":e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"}));r.nestedErrors&&a.importErrors(o),a.addError({name:"anyOf",argument:i,message:"is not any of "+i.join(",")})}return a},Ee.allOf=function(e,t,r,n){if(void 0===e)return null;if(!Array.isArray(t.allOf))throw new Ae("allOf must be an array");var a=new Fe(e,t,r,n),o=this;return t.allOf.forEach((function(t,i){var s=o.validateSchema(e,t,r,n);if(!s.valid){var u=t.$id||t.id||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+i+"]";a.addError({name:"allOf",argument:{id:u,length:s.errors.length,valid:s},message:"does not match allOf schema "+u+" with "+s.errors.length+" error[s]:"}),a.importErrors(s)}})),a},Ee.oneOf=function(e,t,r,n){if(void 0===e)return null;if(!Array.isArray(t.oneOf))throw new Ae("oneOf must be an array");var a=new Fe(e,t,r,n),o=new Fe(e,t,r,n),i=t.oneOf.filter(je.bind(this,e,r,n,(function(e){o.importErrors(e)}))).length,s=t.oneOf.map((function(e,t){return e.$id||e.id||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"}));return 1!==i&&(r.nestedErrors&&a.importErrors(o),a.addError({name:"oneOf",argument:s,message:"is not exactly one from "+s.join(",")})),a},Ee.if=function(e,t,r,n){if(void 0===e)return null;if(!we.isSchema(t.if))throw new Error('Expected "if" keyword to be a schema');var a,o=je.call(this,e,r,n,null,t.if),i=new Fe(e,t,r,n);if(o){if(void 0===t.then)return;if(!we.isSchema(t.then))throw new Error('Expected "then" keyword to be a schema');a=this.validateSchema(e,t.then,r,n.makeChild(t.then)),i.importErrors(a)}else{if(void 0===t.else)return;if(!we.isSchema(t.else))throw new Error('Expected "else" keyword to be a schema');a=this.validateSchema(e,t.else,r,n.makeChild(t.else)),i.importErrors(a)}return i},Ee.propertyNames=function(e,t,r,n){if(this.types.object(e)){var a=new Fe(e,t,r,n),o=void 0!==t.propertyNames?t.propertyNames:{};if(!we.isSchema(o))throw new Ae('Expected "propertyNames" to be a schema (object or boolean)');for(var i in e)if(void 0!==ze(e,i)){var s=this.validateSchema(i,o,r,n.makeChild(o));a.importErrors(s)}return a}},Ee.properties=function(e,t,r,n){if(this.types.object(e)){var a=new Fe(e,t,r,n),o=t.properties||{};for(var i in o){var s=o[i];if(void 0!==s){if(null===s)throw new Ae('Unexpected null, expected schema in "properties"');"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,i,s,r,n);var u=ze(e,i),c=this.validateSchema(u,s,r,n.makeChild(s,i));c.instance!==a.instance[i]&&(a.instance[i]=c.instance),a.importErrors(c)}}return a}},Ee.patternProperties=function(e,t,r,n){if(this.types.object(e)){var a=new Fe(e,t,r,n),o=t.patternProperties||{};for(var i in e){var s=!0;for(var u in o){var c=o[u];if(void 0!==c){if(null===c)throw new Ae('Unexpected null, expected schema in "patternProperties"');try{var f=new RegExp(u,"u")}catch(e){f=new RegExp(u)}if(f.test(i)){s=!1,"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,i,c,r,n);var h=this.validateSchema(e[i],c,r,n.makeChild(c,i));h.instance!==a.instance[i]&&(a.instance[i]=h.instance),a.importErrors(h)}}}s&&Oe.call(this,e,t,r,n,i,a)}return a}},Ee.additionalProperties=function(e,t,r,n){if(this.types.object(e)){if(t.patternProperties)return null;var a=new Fe(e,t,r,n);for(var o in e)Oe.call(this,e,t,r,n,o,a);return a}},Ee.minProperties=function(e,t,r,n){if(this.types.object(e)){var a=new Fe(e,t,r,n);return Object.keys(e).length>=t.minProperties||a.addError({name:"minProperties",argument:t.minProperties,message:"does not meet minimum property length of "+t.minProperties}),a}},Ee.maxProperties=function(e,t,r,n){if(this.types.object(e)){var a=new Fe(e,t,r,n);return Object.keys(e).length<=t.maxProperties||a.addError({name:"maxProperties",argument:t.maxProperties,message:"does not meet maximum property length of "+t.maxProperties}),a}},Ee.items=function(e,t,r,n){var a=this;if(this.types.array(e)&&void 0!==t.items){var o=new Fe(e,t,r,n);return e.every((function(e,i){if(Array.isArray(t.items))var s=void 0===t.items[i]?t.additionalItems:t.items[i];else s=t.items;if(void 0===s)return!0;if(!1===s)return o.addError({name:"items",message:"additionalItems not permitted"}),!1;var u=a.validateSchema(e,s,r,n.makeChild(s,i));return u.instance!==o.instance[i]&&(o.instance[i]=u.instance),o.importErrors(u),!0})),o}},Ee.contains=function(e,t,r,n){var a=this;if(this.types.array(e)&&void 0!==t.contains){if(!we.isSchema(t.contains))throw new Error('Expected "contains" keyword to be a schema');var o=new Fe(e,t,r,n);return!1===e.some((function(e,o){return 0===a.validateSchema(e,t.contains,r,n.makeChild(t.contains,o)).errors.length}))&&o.addError({name:"contains",argument:t.contains,message:"must contain an item matching given schema"}),o}},Ee.minimum=function(e,t,r,n){if(this.types.number(e)){var a=new Fe(e,t,r,n);return t.exclusiveMinimum&&!0===t.exclusiveMinimum?e>t.minimum||a.addError({name:"minimum",argument:t.minimum,message:"must be greater than "+t.minimum}):e>=t.minimum||a.addError({name:"minimum",argument:t.minimum,message:"must be greater than or equal to "+t.minimum}),a}},Ee.maximum=function(e,t,r,n){if(this.types.number(e)){var a=new Fe(e,t,r,n);return t.exclusiveMaximum&&!0===t.exclusiveMaximum?e<t.maximum||a.addError({name:"maximum",argument:t.maximum,message:"must be less than "+t.maximum}):e<=t.maximum||a.addError({name:"maximum",argument:t.maximum,message:"must be less than or equal to "+t.maximum}),a}},Ee.exclusiveMinimum=function(e,t,r,n){if("boolean"!=typeof t.exclusiveMinimum&&this.types.number(e)){var a=new Fe(e,t,r,n);return e>t.exclusiveMinimum||a.addError({name:"exclusiveMinimum",argument:t.exclusiveMinimum,message:"must be strictly greater than "+t.exclusiveMinimum}),a}},Ee.exclusiveMaximum=function(e,t,r,n){if("boolean"!=typeof t.exclusiveMaximum&&this.types.number(e)){var a=new Fe(e,t,r,n);return e<t.exclusiveMaximum||a.addError({name:"exclusiveMaximum",argument:t.exclusiveMaximum,message:"must be strictly less than "+t.exclusiveMaximum}),a}};var Se=function(e,t,r,n,a,o){if(this.types.number(e)){var i=t[a];if(0==i)throw new Ae(a+" cannot be zero");var s=new Fe(e,t,r,n),u=we.getDecimalPlaces(e),c=we.getDecimalPlaces(i),f=Math.max(u,c),h=Math.pow(10,f);return Math.round(e*h)%Math.round(i*h)!=0&&s.addError({name:a,argument:i,message:o+JSON.stringify(i)}),s}};function Ze(e,t,r){var n,a=r.length;for(n=t+1;n<a;n++)if(we.deepCompareStrict(e,r[n]))return!1;return!0}Ee.multipleOf=function(e,t,r,n){return Se.call(this,e,t,r,n,"multipleOf","is not a multiple of (divisible by) ")},Ee.divisibleBy=function(e,t,r,n){return Se.call(this,e,t,r,n,"divisibleBy","is not divisible by (multiple of) ")},Ee.required=function(e,t,r,n){var a=new Fe(e,t,r,n);return void 0===e&&!0===t.required?a.addError({name:"required",message:"is required"}):this.types.object(e)&&Array.isArray(t.required)&&t.required.forEach((function(t){void 0===ze(e,t)&&a.addError({name:"required",argument:t,message:"requires property "+JSON.stringify(t)})})),a},Ee.pattern=function(e,t,r,n){if(this.types.string(e)){var a=new Fe(e,t,r,n),o=t.pattern;try{var i=new RegExp(o,"u")}catch(e){i=new RegExp(o)}return e.match(i)||a.addError({name:"pattern",argument:t.pattern,message:"does not match pattern "+JSON.stringify(t.pattern.toString())}),a}},Ee.format=function(e,t,r,n){if(void 0!==e){var a=new Fe(e,t,r,n);return a.disableFormat||we.isFormat(e,t.format,this)||a.addError({name:"format",argument:t.format,message:"does not conform to the "+JSON.stringify(t.format)+" format"}),a}},Ee.minLength=function(e,t,r,n){if(this.types.string(e)){var a=new Fe(e,t,r,n),o=e.match(/[\uDC00-\uDFFF]/g);return e.length-(o?o.length:0)>=t.minLength||a.addError({name:"minLength",argument:t.minLength,message:"does not meet minimum length of "+t.minLength}),a}},Ee.maxLength=function(e,t,r,n){if(this.types.string(e)){var a=new Fe(e,t,r,n),o=e.match(/[\uDC00-\uDFFF]/g);return e.length-(o?o.length:0)<=t.maxLength||a.addError({name:"maxLength",argument:t.maxLength,message:"does not meet maximum length of "+t.maxLength}),a}},Ee.minItems=function(e,t,r,n){if(this.types.array(e)){var a=new Fe(e,t,r,n);return e.length>=t.minItems||a.addError({name:"minItems",argument:t.minItems,message:"does not meet minimum length of "+t.minItems}),a}},Ee.maxItems=function(e,t,r,n){if(this.types.array(e)){var a=new Fe(e,t,r,n);return e.length<=t.maxItems||a.addError({name:"maxItems",argument:t.maxItems,message:"does not meet maximum length of "+t.maxItems}),a}},Ee.uniqueItems=function(e,t,r,n){if(!0===t.uniqueItems&&this.types.array(e)){var a=new Fe(e,t,r,n);return e.every(Ze)||a.addError({name:"uniqueItems",message:"contains duplicate item"}),a}},Ee.dependencies=function(e,t,r,n){if(this.types.object(e)){var a=new Fe(e,t,r,n);for(var o in t.dependencies)if(void 0!==e[o]){var i=t.dependencies[o],s=n.makeChild(i,o);if("string"==typeof i&&(i=[i]),Array.isArray(i))i.forEach((function(t){void 0===e[t]&&a.addError({name:"dependencies",argument:s.propertyPath,message:"property "+t+" not found, required by "+s.propertyPath})}));else{var u=this.validateSchema(e,i,r,s);a.instance!==u.instance&&(a.instance=u.instance),u&&u.errors.length&&(a.addError({name:"dependencies",argument:s.propertyPath,message:"does not meet dependency required by "+s.propertyPath}),a.importErrors(u))}}return a}},Ee.enum=function(e,t,r,n){if(void 0===e)return null;if(!Array.isArray(t.enum))throw new Ae("enum expects an array",t);var a=new Fe(e,t,r,n);return t.enum.some(we.deepCompareStrict.bind(null,e))||a.addError({name:"enum",argument:t.enum,message:"is not one of enum values: "+t.enum.map(String).join(",")}),a},Ee.const=function(e,t,r,n){if(void 0===e)return null;var a=new Fe(e,t,r,n);return we.deepCompareStrict(t.const,e)||a.addError({name:"const",argument:t.const,message:"does not exactly match expected constant: "+t.const}),a},Ee.not=Ee.disallow=function(e,t,r,n){var a=this;if(void 0===e)return null;var o=new Fe(e,t,r,n),i=t.not||t.disallow;return i?(Array.isArray(i)||(i=[i]),i.forEach((function(i){if(a.testType(e,t,r,n,i)){var s=i&&(i.$id||i.id)||i;o.addError({name:"not",argument:s,message:"is of prohibited type "+s})}})),o):null};var De=xe,$e={},Ne=ae,Re=oe;function Pe(e,t){this.id=e,this.ref=t}$e.SchemaScanResult=Pe,$e.scan=function(e,t){function r(e,t){if(t&&"object"==typeof t)if(t.$ref){var s=Ne.resolve(e,t.$ref);i[s]=i[s]?i[s]+1:0}else{var u=t.$id||t.id,c=u?Ne.resolve(e,u):e;if(c){if(c.indexOf("#")<0&&(c+="#"),o[c]){if(!Re.deepCompareStrict(o[c],t))throw new Error("Schema <"+c+"> already exists with different definition");return o[c]}o[c]=t,"#"==c[c.length-1]&&(o[c.substring(0,c.length-1)]=t)}n(c+"/items",Array.isArray(t.items)?t.items:[t.items]),n(c+"/extends",Array.isArray(t.extends)?t.extends:[t.extends]),r(c+"/additionalItems",t.additionalItems),a(c+"/properties",t.properties),r(c+"/additionalProperties",t.additionalProperties),a(c+"/definitions",t.definitions),a(c+"/patternProperties",t.patternProperties),a(c+"/dependencies",t.dependencies),n(c+"/disallow",t.disallow),n(c+"/allOf",t.allOf),n(c+"/anyOf",t.anyOf),n(c+"/oneOf",t.oneOf),r(c+"/not",t.not)}}function n(e,t){if(Array.isArray(t))for(var n=0;n<t.length;n++)r(e+"/"+n,t[n])}function a(e,t){if(t&&"object"==typeof t)for(var n in t)r(e+"/"+n,t[n])}var o={},i={};return r(e,t),new Pe(o,i)};var _e=ae,Ce=De,Ie=oe,ke=$e.scan,qe=Ie.ValidatorResult,Ve=Ie.ValidatorResultError,Me=Ie.SchemaError,Te=Ie.SchemaContext,Le=function e(){this.customFormats=Object.create(e.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(Be),this.attributes=Object.create(Ce.validators)};function Ue(e){var t="string"==typeof e?e:e.$ref;return"string"==typeof t&&t}Le.prototype.customFormats={},Le.prototype.schemas=null,Le.prototype.types=null,Le.prototype.attributes=null,Le.prototype.unresolvedRefs=null,Le.prototype.addSchema=function(e,t){var r=this;if(!e)return null;var n=ke(t||"/",e),a=t||e.$id||e.id;for(var o in n.id)this.schemas[o]=n.id[o];for(var o in n.ref)this.unresolvedRefs.push(o);return this.unresolvedRefs=this.unresolvedRefs.filter((function(e){return void 0===r.schemas[e]})),this.schemas[a]},Le.prototype.addSubSchemaArray=function(e,t){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addSubSchema(e,t[r])},Le.prototype.addSubSchemaObject=function(e,t){if(t&&"object"==typeof t)for(var r in t)this.addSubSchema(e,t[r])},Le.prototype.setSchemas=function(e){this.schemas=e},Le.prototype.getSchema=function(e){return this.schemas[e]},Le.prototype.validate=function(e,t,r,n){if("boolean"!=typeof t&&"object"!=typeof t||null===t)throw new Me("Expected `schema` to be an object or boolean");r||(r={});var a,o=t.$id||t.id,i=_e.resolve(r.base||"/",o||"");if(!n){(n=new Te(t,r,[],i,Object.create(this.schemas))).schemas[i]||(n.schemas[i]=t);var s=ke(i,t);for(var u in s.id){var c=s.id[u];n.schemas[u]=c}}if(r.required&&void 0===e)return(a=new qe(e,t,r,n)).addError("is required, but is undefined"),a;if(!(a=this.validateSchema(e,t,r,n)))throw new Error("Result undefined");if(r.throwAll&&a.errors.length)throw new Ve(a);return a},Le.prototype.validateSchema=function(e,t,r,n){var a=new qe(e,t,r,n);if("boolean"==typeof t)!0===t?t={}:!1===t&&(t={type:[]});else if(!t)throw new Error("schema is undefined");if(t.extends)if(Array.isArray(t.extends)){var o={schema:t,ctx:n};t.extends.forEach(this.schemaTraverser.bind(this,o)),t=o.schema,o.schema=null,o.ctx=null,o=null}else t=Ie.deepMerge(t,this.superResolve(t.extends,n));var i=Ue(t);if(i){var s=this.resolve(t,i,n),u=new Te(s.subschema,r,n.path,s.switchSchema,n.schemas);return this.validateSchema(e,s.subschema,r,u)}var c=r&&r.skipAttributes||[];for(var f in t)if(!Ce.ignoreProperties[f]&&c.indexOf(f)<0){var h=null,l=this.attributes[f];if(l)h=l.call(this,e,t,r,n);else if(!1===r.allowUnknownAttributes)throw new Me("Unsupported attribute: "+f,t);h&&a.importErrors(h)}if("function"==typeof r.rewrite){var d=r.rewrite.call(this,e,t,r,n);a.instance=d}return a},Le.prototype.schemaTraverser=function(e,t){e.schema=Ie.deepMerge(e.schema,this.superResolve(t,e.ctx))},Le.prototype.superResolve=function(e,t){var r=Ue(e);return r?this.resolve(e,r,t).subschema:e},Le.prototype.resolve=function(e,t,r){if(t=r.resolve(t),r.schemas[t])return{subschema:r.schemas[t],switchSchema:t};var n=_e.parse(t),a=n&&n.hash,o=a&&a.length&&t.substr(0,t.length-a.length);if(!o||!r.schemas[o])throw new Me("no such schema <"+t+">",e);var i=Ie.objectGetPath(r.schemas[o],a.substr(1));if(void 0===i)throw new Me("no such schema "+a+" located in <"+o+">",e);return{subschema:i,switchSchema:t}},Le.prototype.testType=function(e,t,r,n,a){if(void 0!==a){if(null===a)throw new Me('Unexpected null in "type" keyword');if("function"==typeof this.types[a])return this.types[a].call(this,e);if(a&&"object"==typeof a){var o=this.validateSchema(e,a,r,n);return void 0===o||!(o&&o.errors.length)}return!0}};var Be=Le.prototype.types={};Be.string=function(e){return"string"==typeof e},Be.number=function(e){return"number"==typeof e&&isFinite(e)},Be.integer=function(e){return"number"==typeof e&&e%1==0},Be.boolean=function(e){return"boolean"==typeof e},Be.array=function(e){return Array.isArray(e)},Be.null=function(e){return null===e},Be.date=function(e){return e instanceof Date},Be.any=function(e){return!0},Be.object=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&!(e instanceof Date)};var Je=Le;oe.ValidatorResult,oe.ValidatorResultError,oe.ValidationError,oe.SchemaError;var Ye="^[a-zA-Z0-9_.-]*$",Ge={type:"object",id:"/CreateFsPropsSchema",properties:{databaseName:{minLength:4,maxLength:50,type:"string",pattern:Ye},objectStoreName:{minLength:1,maxLength:20,type:"string",pattern:Ye},rootDirectoryName:{minLength:1,maxLength:20,type:"string",pattern:Ye},databaseVersion:{minimum:1,maximum:100,type:"integer"}},required:["databaseName","databaseVersion","objectStoreName","rootDirectoryName"]};function He(e){var t,r,n,a=(t=e,r=Ge,(new Je).validate(t,r,n)),o=a.valid,i=a.errors;if(o)return o;var s=JSON.stringify(i);throw new Error("Props passed to createFS function are invalid:\n".concat(s))}function Ke(e,t){if(""===e)return t;var r=function(e,t){if(!a(e)||!a(t)||""===t)return!1;var r="".concat(t,"/");return e.startsWith(r)}(e,t);if(!r){var n=function(e){return!(!a(e)||0===e.length)&&"/"===e[0]}(e);return"".concat(t).concat(n?"":"/").concat(e)}return e}function We(e,t){if(!a(t)||""===t)throw new Error("rootDirectoryName parameter was not provided");if(!a(e))throw new Error("fullPath parameter was not provided");if(e===t)return t;var r=Ke(e,t);if(!r||!function(e){return!!a(e)&&o.test(e)}(r))throw new Error('"'.concat(e,'" path is invalid.'));return r}var Xe,Qe=function(e){var t=e.result;return Boolean(null==t?void 0:t.createdAt)};!function(e){e.FILE="file",e.DIRECTORY="directory"}(Xe||(Xe={}));var et=function(e){var t=e.result;return Boolean((null==t?void 0:t.type)===Xe.FILE)},tt=function(e){var t=e.result;return Boolean((null==t?void 0:t.type)===Xe.DIRECTORY)},rt=function(e){return e.result},nt=function(e){var t=e.openCursor,a=e.isDirectory,o=e.rootDirectoryName;return function(e){return r(void 0,void 0,void 0,(function(){var r,i,s,u;return n(this,(function(n){switch(n.label){case 0:return r=We(e,o),[4,a(e)];case 1:if(!n.sent())throw new Error('"'.concat(r,'" is not a directory.'));return i=[],s=[],u=function(e,t){var r=e.result;if(r){var n=r.value;if(n.type===Xe.FILE){n.data;var a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(n,["data"]);i.push(a)}else n.type!==Xe.DIRECTORY||n.isRoot||s.push(n);r.continue()}else{var o=i.length,u=s.length;t({isEmpty:0===o&&0===u,filesCount:o,directoriesCount:u,files:i,directories:s})}},[2,t(r,u)]}}))}))}},at=function(e){return e.result},ot="directory";function it(e){return e?e.result:null}function st(e,t){t||e(new Error("Something went wrong and the database transaction was not opened."))}var ut=function(e){var t=e.databaseName,r=e.databaseVersion,n=e.objectStoreName;return new Promise((function(e,a){var o=dt(t,r);o.onerror=a,o.onsuccess=function(t){var r=it(t.target);st(a,r),e(r)},o.onupgradeneeded=function(e){var t=it(e.target);st(a,t),t.createObjectStore(n,{keyPath:"fullPath"}).createIndex(ot,ot,{unique:!1})}}))},ct=function(e){var t=e.initializeObjectStore;return function(e){return r(void 0,void 0,void 0,(function(){var r;return n(this,(function(n){switch(n.label){case 0:return[4,t("readwrite")];case 1:return r=n.sent(),[2,new Promise((function(t,n){var a=r.put(e);a.onerror=n,a.onsuccess=function(){return t(e)}}))]}}))}))}},ft=function(e){var t=e.initializeObjectStore;return function(e,a){return r(void 0,void 0,void 0,(function(){var r;return n(this,(function(n){switch(n.label){case 0:return[4,t("readonly")];case 1:return r=n.sent(),[2,new Promise((function(t,n){var o=r.get(e);o.onerror=n,o.onsuccess=function(e){return t(a(null==e?void 0:e.target))}}))]}}))}))}},ht=function(e){var t=e.initializeObjectStore;return function(e,a){return r(void 0,void 0,void 0,(function(){var r,o,i,s;return n(this,(function(n){switch(n.label){case 0:return[4,t("readonly")];case 1:return r=n.sent(),o=r.index(ot),i=IDBKeyRange.only(e),s=o.openCursor(i),[2,new Promise((function(e,t){s.onerror=t,s.onsuccess=function(t){var r=t.target;return a(r,e)}}))]}}))}))}},lt=function(e){var t=e.initializeObjectStore;return function(e){return r(void 0,void 0,void 0,(function(){var r;return n(this,(function(n){switch(n.label){case 0:return[4,t("readwrite")];case 1:return r=n.sent(),[2,new Promise((function(t,n){var a=r.delete(e);a.onerror=n,a.onsuccess=function(){return t()}}))]}}))}))}},dt=function(e,t){return indexedDB.open(e,t)},mt=function(e){var t=e.databaseName,a=e.databaseVersion,o=e.objectStoreName;return function(e){return r(void 0,void 0,void 0,(function(){var r;return n(this,(function(n){switch(n.label){case 0:return[4,ut({databaseName:t,databaseVersion:a,objectStoreName:o})];case 1:return r=n.sent(),[2,r.transaction(o,e).objectStore(o)]}}))}))}},pt={databaseVersion:1,objectStoreName:"files",rootDirectoryName:"root",databaseName:"indexeddb-fs"};function vt(e){var a=this,o=void 0===e?pt:e,s=o.databaseName,u=void 0===s?pt.databaseName:s,c=o.databaseVersion,f=void 0===c?pt.databaseVersion:c,h=o.objectStoreName,l=void 0===h?pt.objectStoreName:h,m=o.rootDirectoryName,p=void 0===m?pt.rootDirectoryName:m;var y=function(e){var t=e.databaseName,r=e.databaseVersion,n=e.objectStoreName,a=mt({databaseName:t,databaseVersion:r,objectStoreName:n});return{getRecord:ft({initializeObjectStore:a}),putRecord:ct({initializeObjectStore:a}),openCursor:ht({initializeObjectStore:a}),deleteRecord:lt({initializeObjectStore:a})}}({databaseName:u,databaseVersion:f,objectStoreName:l}),b=y.getRecord,g=y.putRecord,w=y.openCursor,F=y.deleteRecord,A=function(e){var t=e.getRecord,a=e.rootDirectoryName;return function(e){return r(void 0,void 0,void 0,(function(){var r;return n(this,(function(n){return r=We(e,a),[2,t(r,Qe)]}))}))}}({getRecord:b,rootDirectoryName:p}),x=function(e){var t=e.exists,a=e.getRecord,o=e.rootDirectoryName;return function(e){return r(void 0,void 0,void 0,(function(){var r;return n(this,(function(n){switch(n.label){case 0:return r=We(e,o),[4,t(r)];case 1:if(!n.sent())throw new Error('"'.concat(r,'" file does not exist.'));return[2,a(r,et)]}}))}))}}({exists:A,getRecord:b,rootDirectoryName:p}),E=function(e){var t=e.exists,a=e.deleteRecord,o=e.rootDirectoryName;return function(e){return r(void 0,void 0,void 0,(function(){var r;return n(this,(function(n){switch(n.label){case 0:return r=We(e,o),[4,t(r)];case 1:if(!n.sent())throw new Error('"'.concat(r,'" file or directory does not exist.'));return[2,a(r)]}}))}))}}({exists:A,deleteRecord:F,rootDirectoryName:p}),j=function(e){var t=e.isFile,a=e.getRecord,o=e.rootDirectoryName;return function(e){return r(void 0,void 0,void 0,(function(){var r;return n(this,(function(n){switch(n.label){case 0:return r=We(e,o),[4,t(r)];case 1:if(!n.sent())throw new Error('"'.concat(r,'" is not a file.'));return[2,a(r,rt)]}}))}))}}({isFile:x,getRecord:b,rootDirectoryName:p}),z=function(e){var t=e.fileDetails;return function(e){return r(void 0,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return[4,t(e)];case 1:return[2,r.sent().data]}}))}))}}({fileDetails:j}),O=function(e){var t=e.isFile,a=e.deleteRecord,o=e.rootDirectoryName;return function(e){return r(void 0,void 0,void 0,(function(){var r;return n(this,(function(n){switch(n.label){case 0:return r=We(e,o),[4,t(r)];case 1:if(!n.sent())throw new Error('"'.concat(r,'" is not a file.'));return[2,a(r)]}}))}))}}({isFile:x,deleteRecord:F,rootDirectoryName:p}),S=function(e){var t=e.exists,a=e.getRecord,o=e.rootDirectoryName;return function(e){return r(void 0,void 0,void 0,(function(){var r;return n(this,(function(n){switch(n.label){case 0:return r=We(e,o),[4,t(r)];case 1:if(!n.sent())throw new Error('"'.concat(r,'" directory does not exist.'));return[2,a(r,tt)]}}))}))}}({exists:A,getRecord:b,rootDirectoryName:p}),Z=function(e){var t=e.putRecord,a=e.isDirectory,o=e.rootDirectoryName;return function(e,s){return r(void 0,void 0,void 0,(function(){var r,u,c,f;return n(this,(function(n){switch(n.label){case 0:if((r=We(e,o))===o)throw new Error('Root directory: "'.concat(r,'" cannot be a file.'));return u=d.basename(r),c=v(r,o),[4,a(c)];case 1:if(!n.sent())throw new Error('"'.concat(c,'" directory does not exist.'));return[4,i((function(){return a(r)}),(function(){return!1}))];case 2:if(n.sent())throw new Error('"'.concat(r,'" you cannot create a file with the same name as the directory.'));return f={data:s,directory:c,name:u,type:Xe.FILE,createdAt:Date.now(),fullPath:r},[2,t(f)]}}))}))}}({putRecord:g,isDirectory:S,rootDirectoryName:p}),D=function(e){var t=e.isFile,a=e.exists,o=e.writeFile,i=e.isDirectory,s=e.fileDetails,u=e.rootDirectoryName;return function(e,c){return r(void 0,void 0,void 0,(function(){var r,f,h,l;return n(this,(function(n){switch(n.label){case 0:return r=We(e,u),f=We(c,u),[4,t(r)];case 1:if(!n.sent())throw new Error('"'.concat(r,'" source is not a file.'));return h=v(f,u),[4,i(h)];case 2:if(!n.sent())throw new Error('"'.concat(h,'" destination directory does not exist.'));return[4,a(f)];case 3:if(n.sent())throw new Error('"'.concat(f,'" is already taken.'));return[4,s(r)];case 4:return l=n.sent(),[2,o(f,l.data)]}}))}))}}({exists:A,isFile:x,writeFile:Z,fileDetails:j,isDirectory:S,rootDirectoryName:p}),$=nt({openCursor:w,isDirectory:S,rootDirectoryName:p}),N=function(e){var t=e.isFile,a=e.putRecord,o=e.isDirectory,s=e.rootDirectoryName;return function(e){return r(void 0,void 0,void 0,(function(){var r,u,c,f;return n(this,(function(n){switch(n.label){case 0:if((r=We(e,s))===s)throw new Error('Root directory: "'.concat(r,'" already exist.'));return u=d.basename(r),c=v(r,s),[4,o(c)];case 1:if(!n.sent())throw new Error('"'.concat(c,'" is not a directory.'));return[4,i((function(){return t(r)}),(function(){return!1}))];case 2:if(n.sent())throw new Error('"'.concat(r,'" you cannot create a directory with the same name as the file.'));return f={directory:c,isRoot:!1,name:u,createdAt:Date.now(),type:Xe.DIRECTORY,fullPath:r},[2,a(f)]}}))}))}}({isFile:x,putRecord:g,isDirectory:S,rootDirectoryName:p}),R=function(e){var t=e.remove,a=e.isDirectory,o=e.readDirectory,s=e.rootDirectoryName;function u(e){return r(this,void 0,void 0,(function(){var r,a,c,f,h,l,d,m,p,v,y,b,g;return n(this,(function(w){switch(w.label){case 0:return r=We(e,s),[4,o(r)];case 1:if(a=w.sent(),c=a.files,f=a.filesCount,h=a.directories,l=a.directoriesCount,!(f>0))return[3,5];d=0,m=c,w.label=2;case 2:return d<m.length?(p=m[d],[4,t(p.fullPath)]):[3,5];case 3:w.sent(),w.label=4;case 4:return d++,[3,2];case 5:return l?[3,7]:[4,t(e)];case 6:return w.sent(),[2];case 7:v=function(e){return n(this,(function(r){switch(r.label){case 0:return e.isRoot?[3,2]:[4,u(e.fullPath)];case 1:r.sent(),r.label=2;case 2:return[4,i((function(){return t(e.fullPath)}))];case 3:return r.sent(),[2]}}))},y=0,b=h,w.label=8;case 8:return y<b.length?(g=b[y],[5,v(g)]):[3,11];case 9:w.sent(),w.label=10;case 10:return y++,[3,8];case 11:return[2]}}))}))}return function(e){return r(this,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return[4,a(e)];case 1:if(!r.sent())throw new Error('"'.concat(e,'" is not a directory.'));return[4,u(e)];case 2:return r.sent(),e===s?[3,4]:[4,i((function(){return t(e)}))];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}}({remove:E,isDirectory:S,readDirectory:$,rootDirectoryName:p}),P=function(e){var t=e.getRecord,a=e.isDirectory,o=e.rootDirectoryName;return function(e){return r(void 0,void 0,void 0,(function(){var r;return n(this,(function(n){switch(n.label){case 0:return r=We(e,o),[4,a(e)];case 1:if(!n.sent())throw new Error('"'.concat(r,'" is not a directory.'));return[2,t(r,at)]}}))}))}}({getRecord:b,isDirectory:S,rootDirectoryName:p}),_=function(e){var t=e.exists,a=e.isFile,o=e.isDirectory,i=e.fileDetails,s=e.directoryDetails,u=e.rootDirectoryName;return function(e){return r(void 0,void 0,void 0,(function(){var r,c,f;return n(this,(function(n){switch(n.label){case 0:return r=We(e,u),[4,t(r)];case 1:if(!n.sent())throw new Error('"'.concat(r,'" file or directory does not exist.'));return[4,a(r)];case 2:return c=n.sent(),[4,o(r)];case 3:if(f=n.sent(),c&&f)throw new Error('"'.concat(r,'" is a path of file and directory.'));return c?[2,i(r)]:[2,s(r)]}}))}))}}({isFile:x,exists:A,isDirectory:S,fileDetails:j,directoryDetails:P,rootDirectoryName:p}),C=function(e){var a=e.putRecord,o=e.isDirectory,s=e.fileDetails,u=e.rootDirectoryName;return function(e,c){return r(void 0,void 0,void 0,(function(){var r,f,h,l;return n(this,(function(n){switch(n.label){case 0:if((r=We(e,u))===u)throw new Error('Root directory: "'.concat(r,'" cannot be updated.'));return f=v(r,u),[4,o(f)];case 1:if(!n.sent())throw new Error('"'.concat(f,'" is not a directory.'));return[4,i((function(){return o(r)}),(function(){return!1}))];case 2:if(n.sent())throw new Error('"'.concat(r,'" you cannot update a directory.'));return[4,s(r)];case 3:return h=n.sent(),l=t(t({},h),c),[2,a(l)]}}))}))}}({putRecord:g,fileDetails:j,isDirectory:S,rootDirectoryName:p}),I=function(e){var t=e.isFile,a=e.exists,o=e.removeFile,i=e.isDirectory,s=e.updateFileDetails,u=e.rootDirectoryName;return function(e,c){return r(void 0,void 0,void 0,(function(){var r,f,h,l,m;return n(this,(function(n){switch(n.label){case 0:return r=We(e,u),f=We(c,u),[4,t(r)];case 1:if(!n.sent())throw new Error('"'.concat(r,'" source is not a file.'));return h=v(f,u),[4,i(h)];case 2:if(!n.sent())throw new Error('"'.concat(h,'" destination directory does not exist.'));return[4,a(f)];case 3:if(n.sent())throw new Error('"'.concat(f,'" is already taken.'));return l=d.basename(f),[4,s(r,{name:l,directory:h,fullPath:f})];case 4:return m=n.sent(),[4,o(r)];case 5:return n.sent(),[2,m]}}))}))}}({exists:A,isFile:x,removeFile:O,isDirectory:S,updateFileDetails:C,rootDirectoryName:p}),k=function(e){var t=e.isFile,a=e.exists,o=e.removeFile,i=e.updateFileDetails,s=e.rootDirectoryName;return function(e,u){return r(void 0,void 0,void 0,(function(){var r,c,f,h;return n(this,(function(n){switch(n.label){case 0:return r=We(e,s),[4,t(r)];case 1:if(!n.sent())throw new Error('"'.concat(r,'" is not a file.'));return c=v(r,s),f="".concat(c,"/").concat(u),[4,a(f)];case 2:if(n.sent())throw new Error('"'.concat(f,'" is already taken.'));return[4,i(r,{name:u,fullPath:f})];case 3:return h=n.sent(),[4,o(r)];case 4:return n.sent(),[2,h]}}))}))}}({exists:A,isFile:x,removeFile:O,updateFileDetails:C,rootDirectoryName:p}),q=function(e){var t=e.putRecord,a=e.rootDirectoryName;return function(){return r(void 0,void 0,void 0,(function(){var e;return n(this,(function(r){return e={isRoot:!0,createdAt:Date.now(),name:a,type:Xe.DIRECTORY,fullPath:a,directory:a},[2,t(e)]}))}))}}({putRecord:g,rootDirectoryName:p});function V(){return r(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,A(p)];case 1:return e.sent()?[3,3]:[4,q()];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))}var M=function(e){return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return r(a,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return[4,V()];case 1:return r.sent(),[2,e.apply(void 0,t)]}}))}))}};return function(){if(!Boolean(indexedDB))throw new Error("Your browser does not support indexedDB.")}(),He({databaseName:u,objectStoreName:l,databaseVersion:f,rootDirectoryName:p}),{databaseName:u,databaseVersion:f,objectStoreName:l,rootDirectoryName:p,exists:M(A),isFile:M(x),remove:M(E),details:M(_),copyFile:M(D),readFile:M(z),moveFile:M(I),writeFile:M(Z),renameFile:M(k),removeFile:M(O),fileDetails:M(j),isDirectory:M(S),readDirectory:M($),createDirectory:M(N),removeDirectory:M(R),directoryDetails:M(P)}}var yt=vt();e.createFs=vt,e.default=yt,Object.defineProperty(e,"__esModule",{value:!0})}));
